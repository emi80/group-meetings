<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<meta name="description" content="Lab Meeting">
		<meta name="author" content="Emilio Palumbo">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="../bootstrap/css/bootstrap.min.css">
		<link rel="stylesheet" href="../bootstrap/css/bootstrap-theme.min.css">
		<link rel="stylesheet" href="../css/font-awesome-4.5.0.min.css">
		<link rel="stylesheet" href="../reveal.js/css/reveal.css">
		<link rel="stylesheet" href="../css/rg.css">
		<link rel="stylesheet" href="./style.css">
		<link rel="stylesheet" href="../css/badge_only.css">
		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="../reveal.js/lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? '../reveal.js/css/print/pdf.css' : '../reveal.js/css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="../reveal.js/lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>
	  <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container-fluid">
        <div class="navbar-collapse collapse">
		<a class="navbar-brand" href=""></a>
          <ul id="nav-sections" class="nav navbar-nav navbar-right">
          </ul>
        </div>
      </div>
    </div>
		<div class="reveal">
			<div class="container slides">
				<section data-markdown="slides.md"
					data-separator="^------"
					data-separator-vertical="^\n\n"
					data-separator-notes="^Note:"
					data-charset="UTF-8">
				</section>
			</div>
			<div class="rst-versions rst-badge" data-toggle="rst-versions">
		    <span class="rst-current-version" data-toggle="rst-current-version">
		      <span class="fa fa-book"></span>
		      <span class="fa fa-caret-down"></span>
		    </span>
    	<div class="rst-other-versions">
      <dl>
        <dt>Group meetings</dt>
    	</dl>
		</div>
		<script src="../js/jquery-2.0.3.min.js"></script>
		<script src="../js/jquery-migrate-1.2.1.min.js"></script>
		<script src="../reveal.js/lib/js/head.min.js"></script>
		<script src="../reveal.js/js/reveal.js"></script>
		<script src="../bootstrap/js/bootstrap.min.js"></script>
		<script>
			var noNavBar = false;
			var months = ['January','February','March','April','May','June','July','August','September','October','November','December'];
			var date, dateString, locationDate;
			$(document).ready(function() {
				baseUrl = window.location.origin + window.location.pathname.split("/").slice(0,-2).join("/");
				$.get(baseUrl + "/versions.json", function(data) {
					if (typeof(data) == 'string') data = JSON.parse(data);
					$(data).each(function(i, val){
						val.href = baseUrl + "/" + val.href
						var text = '<dd><a href="' + val.href + '">' + date +'</a></dd>'
						$('.rst-other-versions').append(text);
					});
					$('.rst-other-versions a').each(function() {
						var version = $(this);
						$.get(version.attr('href') + "/presentation.json", function(data) {
							if (typeof(data) == 'string') data = JSON.parse(data);
							var date = getPresentationDate(data.date);
							version.text(date);
							if (window.location.href.includes(version.attr('href'))) {
								var currentVersion = '<span class="fa fa-book"></span> ' + date + ' <span class="fa fa-caret-down"></span>';
								$('.rst-current-version').html(currentVersion);
								var titleSlideInfo = '<p><small>Emilio Palumbo<br>' + date + '</small></p>';
								$(Reveal.getSlide(0)).append(titleSlideInfo);
							}
						});
					});
				});
			});
			Reveal.initialize({
				controls: false,
				progress: false,
				history: true,
		        center: true,
		        slideNumber: "c",
		        embedded: false,
		        previewLinks: false,
				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'none', // default/cube/page/concave/zoom/linear/fade/none
				backgroundTransition: 'none',

				margin: 0,
				keyboard: {
					66: toggleFonts,
				},
				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: '../reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: '../reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: '../reveal.js/plugin/zoom-js/zoom.js', async: true },
					{ src: '../reveal.js/plugin/notes/notes.js', async: true }
				]
			});

			function getPresentationDate(dateString) {
				var d = new Date(dateString);
				return months[d.getMonth()] + " " + d.getDate()+ ", " + d.getFullYear();
			}

			function increaseFontWeight(element, ratio) {
				return Math.round(element * ratio / 100) * 100;
			}

			function toggleFonts() {
				fw = ($('body').css('font-weight') == 300) ? 400 : 300;
				$('body').css('font-weight', fw);
				$('.reveal strong').css('font-weight', increaseFontWeight($('body').css('font-weight'), 1.75));
			}

			function vslidedots(event, el){
			  var totalslides = document.querySelectorAll( '.reveal .slides section:not(.stack)' ).length;
			  var current_slide = 0;

			  var horizontal_slides = document.querySelectorAll( '.reveal .slides>section' );
			  var idxh = event.indexh;
			  var idxv = event.indexv;
			  if (el != null) {
			  	idxh = el;
			  	idxv = (el == event.indexh ? event.indexv : 0)
			  }
			  var subslides = horizontal_slides[idxh].querySelectorAll('section');

			  // return current_slide.toString()+"/"+totalslides.toString();
			  return Array(idxv+1).join('<i class="fa fa-dot-circle-o"></i>')+Array(subslides.length-idxv).join('<i class="fa fa-circle-o"></i>');
			}

			function renderPanel(element) {
				var panels = element.find('p');
				var re = /<!-- (panel)([^\(]+)?\(?([^\)]+)?\)? -->/gi
				panels.each(function() {
					var m = re.exec($(this).html())
					if (m) {
						var panelText = $(this).html().replace(re, '');
						var cls = m[1]=='panel' ? 'class="panel panel-default"' : '';
						var char = m[2] == '->' ? 'fa-arrow-circle-right' : 'fa-circle-o';
						var color = m[3];
						// var fa = m[2] && m[3] ? `<i class="fa ${char} ${color}"></i>` : '';
						var fa = m[2] && m[3] ? '<i class="fa ' + char + ' ' + color + '"></i>' : '';
						// $(this).html(`<div><span ${cls}>${fa} ${panelText} </span></div>`);
						// $(this).html(`<div ${cls}>${fa} ${panelText} </div>`);
						$(this).html('<div ' + cls + '>' + fa + ' ' + panelText + ' </div>');
					}
				});
			}

			function setSlideIds(element) {
				var section = element.find('h1').text();
				var slides = element.find('section[data-markdown]');
				slides.each(function() {
					var header = $(this).find('h2').text();
					if (header) {
						$(this).attr('id', (section + header).replace(/ /gi, ''));
					}
				});
			}

			function updateSlide(show) {
				if (!noNavBar && $(Reveal.getCurrentSlide()).attr("data-state")!="no-nav-bar") {
					$(".navbar-fixed-top").css("display", show ? 'block' : "none");
					$('.slide-number').css("visibility", show ? "visible" : "hidden");
				}
				if (Reveal.isFirstSlide()) {
					$('.slide-number').css("visibility","hidden");
				}
				if (Reveal.isLastSlide()) {
					$('.slide-number').css("visibility","hidden");
					$(".navbar-fixed-top").css("display", "none");
				}
			}

			Reveal.addEventListener( 'slidechanged', function( event ) {
				updateSlide(true)
				$("a[id*='nav-']").parent().removeClass("active");
  				$("#nav-" + event.indexh).parent().addClass("active");
				$("a[id*='nav-']").each(function() {
					var text = $(this).html().split("<br>")[0];
					$(this).html(text+"<br>"+vslidedots(event,$(this).attr("id").split("-")[1]));
				})
				var slide = Reveal.getCurrentSlide();
				var header = $(slide).find('h1.extra');
				if (header.length > 0) {
					$('.slide-number').css("visibility","hidden");
				}
			});

			Reveal.addEventListener( 'ready', function( event ) {
				updateSlide(true)
				$('a.extern').attr('target', '_blank');
				$('.rst-other-versions a').attr('target', '');
				document.title = $(Reveal.getSlide(0)).find('h1').text();
				$('.navbar-brand').text(document.title);
				$(".reveal .slides>section").each(function ( index ) {
					var header = $(this).find('h1.extra')
					if (index>0) {
						renderPanel($(this));
						//setSlideIds($(this));
					 	if (header.length == 0) {
						 	$("#nav-sections").append('<li><a id="nav-'+(index)+'" href="#/'+(index)+'">'+$("h1", this).text()+'</a></li>')
					 	}
					}
				});
				$("a[id*='nav-']").parent().removeClass("active");
  				$("#nav-" + event.indexh).parent().addClass("active");
				$("a[id*='nav-']").each(function() {
					var text = $(this).html().split("<br>")[0];
					$(this).html(text+"<br>"+vslidedots(event,$(this).attr("id").split("-")[1]));
				})
			});

			Reveal.addEventListener( 'no-nav-bar', function() {
				updateSlide(false)
			}, false );


			$("[data-toggle='rst-current-version']").click(function() {
        	$("[data-toggle='rst-versions']").toggleClass("shift-up")
      });

			$(document).keypress(function(e){
				if (e.which == 116) toggleNavbar(); // 't' pressed
				if (e.which == 118) toggleVersions(); // 'v' pressed
			});

			function toggleNavbar() {
				var display = ($(".navbar-fixed-top").css("display") == 'block' ? 'none' : 'block');
				$(".navbar-fixed-top").css("display", display);
				noNavBar = (display == 'none')
			}

			function toggleVersions() {
				var display = ($(".rst-versions.rst-badge").css("display") == 'block' ? 'none' : 'block');
				$(".rst-versions.rst-badge").css("display", display)
			}
		</script>
	</body>
</html>
