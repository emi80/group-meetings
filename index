<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<span id="spanDate"></span>

		<meta name="description" content="Lab Meeting">
		<meta name="author" content="Emilio Palumbo">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link href='http://fonts.googleapis.com/css?family=Fauna+One|Fjalla+One' rel='stylesheet' type='text/css'>

		<link rel="stylesheet" href="../bootstrap/css/bootstrap.min.css">
		<link rel="stylesheet" href="../bootstrap/css/bootstrap-theme.min.css">
		<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
		<link rel="stylesheet" href="../css/reveal.min.css">
		<link rel="stylesheet" href="../css/badge_only.css">
		<link rel="stylesheet" href="../css/style.css">
		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="../lib/css/zenburn.css">
		<!-- <link rel="stylesheet" href="../css/ray.css">
		<link rel="stylesheet" href="../css/solarized_dark.css"> -->
		<!-- <link rel="stylesheet" href="../css/theme/default.css" id="theme"> -->
		<script src="http://code.jquery.com/jquery-2.0.3.min.js"></script>
		<script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
		<!-- If the query includes 'print-pdf', include the PDF print sheet -->
		<script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = '../css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
		</script>
		<!--[if lt IE 9]>
		<script src="/lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>
	  <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-collapse collapse">
          <ul id="nav-sections" class="nav navbar-nav navbar-right">
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
		<div class="reveal">
			<div class="container slides">
				<section data-markdown="slides.md"
					data-separator="^------"
					data-vertical="^\n\n"
					data-notes="^Note:"
					data-charset="iso-8859-15">
				</section>
			</div>
			<div class="rst-versions rst-badge" data-toggle="rst-versions">
		    <span class="rst-current-version" data-toggle="rst-current-version">
		      <span class="fa fa-book"></span>
		      <span class="fa fa-caret-down"></span>
		    </span>
    	<div class="rst-other-versions">
      <dl>
        <dt>Group meetings</dt>
    	</dl>
		</div>
		<script src="../lib/js/head.min.js"></script>
		<script src="../js/reveal.min.js"></script>
		<script src="../bootstrap/js/bootstrap.min.js"></script>
		<script>
			var months = ['January','February','March','April','May','June','July','August','September','October','November','December'];
			var date, dateString, locationDate;
			$(document).ready(function() {
				baseUrl = window.location.origin + window.location.pathname.split("/").slice(0,-2).join("/");
				$.get(baseUrl + "/versions.json", function(data) {
					if (typeof(data) == 'string') data = JSON.parse(data);
					$(data).each(function(i, val){
						val.href = baseUrl + "/" + val.href
						var text = '<dd><a href="' + val.href + '">' + date +'</a></dd>'
						$('.rst-other-versions').append(text);
					});
					$('.rst-other-versions a').each(function() {
						var version = $(this);
						$.get(version.attr('href') + "/presentation.json", function(data) {
							if (typeof(data) == 'string') data = JSON.parse(data);
							var date = getPresentationDate(data.date);
							version.text(date);
							if (window.location.href.includes(version.attr('href'))) {
								var currentVersion = '<span class="fa fa-book"></span> ' + date + ' <span class="fa fa-caret-down"></span>';
								$('.rst-current-version').html(currentVersion);
								var titleSlideInfo = '<p><small>Emilio Palumbo<br>' + date + '</small></p>';
								$(Reveal.getSlide(0)).append(titleSlideInfo);
							}
						});
					});
				});
			});
			Reveal.initialize({
				controls: false,
				progress: true,
				history: true,
        center: true,
        slideNumber: true,
        embedded: true,
				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'none', // default/cube/page/concave/zoom/linear/fade/none

				margin: 0,
				keyboard: {
			    66: toggleFonts,
			  },
				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: '../lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: '../plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: '../plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: '../plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

			function getPresentationDate(dateString) {
				var d = new Date(dateString);
				return months[d.getMonth()] + " " + d.getDate()+ ", " + d.getFullYear();
			}

			function increaseFontWeight(element, ratio) {
				return Math.round(element * ratio / 100) * 100;
			}

			function toggleFonts() {
				fw = ($('body').css('font-weight') == 300) ? 400 : 300;
				$('body').css('font-weight', fw);
				$('.reveal strong').css('font-weight', increaseFontWeight($('body').css('font-weight'), 1.75));
			}

			function vslidedots(event, el){
			  var totalslides = document.querySelectorAll( '.reveal .slides section:not(.stack)' ).length;
			  var current_slide = 0;

			  var horizontal_slides = document.querySelectorAll( '.reveal .slides>section' );
			  var idxh = event.indexh;
			  var idxv = event.indexv;
			  if (el != null) {
			  	idxh = el;
			  	idxv = (el == event.indexh ? event.indexv : 0)
			  }
			  var subslides = horizontal_slides[idxh].querySelectorAll('section');

			  // return current_slide.toString()+"/"+totalslides.toString();
			  return Array(idxv+1).join('<i class="fa fa-dot-circle-o"></i>')+Array(subslides.length-idxv).join('<i class="fa fa-circle-o"></i>');
			}

			function renderPanel(element) {
				var panels = element.find('p');
				var re = /<!-- (panel)([^\(]+)?\(?([^\)]+)?\)? -->/gi
				panels.each(function() {
					var m = re.exec($(this).html())
					if (m) {
						var panelText = $(this).html().replace(re, '');
						var cls = m[1]=='panel' ? 'class="panel panel-default"' : '';
						var char = m[2] == '->' ? 'fa-arrow-circle-right' : 'fa-circle-o';
						var color = m[3];
						// var fa = m[2] && m[3] ? `<i class="fa ${char} ${color}"></i>` : '';
						var fa = m[2] && m[3] ? '<i class="fa ' + char + ' ' + color + '"></i>' : '';
						// $(this).html(`<div><span ${cls}>${fa} ${panelText} </span></div>`);
						// $(this).html(`<div ${cls}>${fa} ${panelText} </div>`);
						$(this).html('<div ' + cls + '>' + fa + ' ' + panelText + ' </div>');
					}
				});
			}

			function setSlideIds(element) {
				var section = element.find('h1').text();
				var slides = element.find('section[data-markdown]');
				slides.each(function() {
					var header = $(this).find('h2').text();
					if (header) {
						$(this).attr('id', (section + header).replace(/ /gi, ''));
					}
				});
			}

			Reveal.addEventListener( 'slidechanged', function( event ) {
				$("a[id*='nav-']").parent().removeClass("active");
  				$("#nav-" + event.indexh).parent().addClass("active");
				$("a[id*='nav-']").each(function() {
					var text = $(this).html().split("<br>")[0];
					$(this).html(text+"<br>"+vslidedots(event,$(this).attr("id").split("-")[1]));
				})
			});

			Reveal.addEventListener( 'ready', function( event ) {
				document.title = $(Reveal.getSlide(0)).find('h1').text();
				$(".reveal .slides>section").each(function ( index ) {
					if (index>0) {
						renderPanel($(this));
						setSlideIds($(this));
					 	$("#nav-sections").append('<li><a id="nav-'+(index)+'" href="#/'+(index)+'">'+$("h1", this).text()+'</a></li>')
					}
				});
				$("a[id*='nav-']").parent().removeClass("active");
  				$("#nav-" + event.indexh).parent().addClass("active");
				$("a[id*='nav-']").each(function() {
					var text = $(this).html().split("<br>")[0];
					$(this).html(text+"<br>"+vslidedots(event,$(this).attr("id").split("-")[1]));
				})
			});

			$("[data-toggle='rst-current-version']").click(function() {
        	$("[data-toggle='rst-versions']").toggleClass("shift-up")
      });

			$(document).keypress(function(e){
				if (e.which == 116) toggleNavbar(); // 't' pressed
				if (e.which == 118) toggleVersions(); // 'v' pressed
			});

			function toggleNavbar() {
				var display = ($(".navbar-fixed-top").css("display") == 'block' ? 'none' : 'block');
				$(".navbar-fixed-top").css("display", display);
			}

			function toggleVersions() {
				var display = ($(".rst-versions.rst-badge").css("display") == 'block' ? 'none' : 'block');
				$(".rst-versions.rst-badge").css("display", display)
			}
		</script>
	</body>
</html>
